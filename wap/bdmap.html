<!DOCTYPE html><html lang="en"><head>	<meta charset="UTF-8">	<title>地图位置</title>	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"> 	<meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no">	<meta name="apple-mobile-web-app-capable" content="yes">	<meta name="apple-mobile-web-app-status-bar-style" content="black">	<link rel="stylesheet" href="css/storeset.css">	<script src="js/zepto.min.js"></script>	<script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&amp;ak=8MTeRnQTdIoZSExbNEioTBBd"></script></head><style type="text/css">    html,body{margin:0;padding:0;}    .iw_poi_title {color:#CC5522;font-size:1.4rem;font-weight:bold;overflow:hidden;padding-right:1.3rem;white-space:nowrap}    .iw_poi_content {font:1.2rem arial,sans-serif;overflow:visible;padding-top:4px;white-space:-moz-pre-wrap;word-wrap:break-word}    .mybalance{width:100%;margin: 2rem auto;text-align: center;}		.balance{color: #e63503;font-size: 36px;}		.ticket1{			text-align: left;			line-height: 2.6rem;				margin-top: 0px;			min-height: 50rem;			overflow: hidden;		}		.ticket1 li{margin-top: 1rem;overflow: hidden;padding: 1rem 2rem;			background-color: #fff;}		.ticket1 li dd{border: 0px;}		</style><body>		<div class="container">	<header style="height: 3.8rem;">			<a href="javascript:history.go(-1)" style="left: 1.0rem;top: 1.0rem;"><img src="images/w_sback.png" alt="返回首页" style="width: 1.2rem;height: 1.8rem;"></a>			<p style="line-height: 3.8rem;font-size: 2.0rem;">店铺设置</p>		</header>	</header>	<div class="bank-main">		<div style="padding:3% 5%;">			<i class="icon_position"></i><span id="dizhi" class="position" style="font-size:1.5rem;"></span>			<button  style="font-size:1.5rem;padding:0 0.3rem">确定</button>		</div>		<div id="bdmap" style="width:100%;height:50rem;"></div>	</div>	</div>	<script type="text/javascript">	var address = localStorage.getItem('aadds');	console.log(address);	$("button").on("click",function(){		window.history.back();	})		$(function(){			var map;			initMap();			function initMap(){				map = new BMap.Map("bdmap",{'enableHighResolution':true});				map.centerAndZoom(address,14);				map.highResolutionEnabled();				var geoc = new BMap.Geocoder();				map.enableScrollWheelZoom(true);				map.enableDragging();				map.enableInertialDragging();				var top_left_navigation = new BMap.NavigationControl();				map.addControl(top_left_navigation);  				var mapType1 = new BMap.MapTypeControl({mapTypes: [BMAP_NORMAL_MAP,BMAP_HYBRID_MAP]});				var mapType2 = new BMap.MapTypeControl({anchor: BMAP_ANCHOR_TOP_LEFT});				var overView = new BMap.OverviewMapControl();				var overViewOpen = new BMap.OverviewMapControl({isOpen:true, anchor: BMAP_ANCHOR_BOTTOM_RIGHT});				//map.addControl(overView);          //添加默认缩略地图控件				//添加地图类型和缩略图				function add_control(){					map.addControl(mapType1);          //2D图，卫星图					map.addControl(mapType2);          //左上角，默认地图控件					map.setCurrentCity(address);        //由于有3D图，需要设置城市哦					map.addControl(overView);          //添加默认缩略地图控件					map.addControl(overViewOpen);      //右下角，打开				}				console.log(address);				map.addEventListener("click", function(e){					var pt = e.point;					addMarker(pt.lng,pt.lat);					geoc.getLocation(pt, function(rs){						var addComp = rs.addressComponents;						console.log(addComp.province + ", " + addComp.city + ", " + addComp.district + ", " + addComp.street + ", " + addComp.streetNumber);						$(".position").html(addComp.province + " " + addComp.city + " " + addComp.district + " " + addComp.street + " " + addComp.streetNumber);						var marker = new BMap.Marker(pt);						map.addOverlay(marker);						localStorage.removeItem('mapAddress');						localStorage.removeItem('position');						localStorage.setItem('position',pt.lng+','+pt.lat);						localStorage.setItem('mapAddress',addComp.city + " " + addComp.district + " " + addComp.street + " " + addComp.streetNumber);					});				});				map.addEventListener("touchend",function(e){					var pt = e.point;					addMarker(pt.lng,pt.lat);					geoc.getLocation(pt, function(rs){						var addComp = rs.addressComponents;						console.log(addComp.province + ", " + addComp.city + ", " + addComp.district + ", " + addComp.street + ", " + addComp.streetNumber);						$(".position").html(addComp.province + " " + addComp.city + " " + addComp.district + " " + addComp.street + " " + addComp.streetNumber);						localStorage.removeItem('mapAddress');						localStorage.removeItem('position');						localStorage.setItem('position',pt.lng+','+pt.lat);						localStorage.setItem('mapAddress',addComp.city + " " + addComp.district + " " + addComp.street + " " + addComp.streetNumber);					});				});				getLocation();			}			function getLocation(){				if(address){				  map.centerAndZoom(address,14);				}else{				var geolocation = new BMap.Geolocation();				geolocation.getCurrentPosition(function(r){					if(this.getStatus() == BMAP_STATUS_SUCCESS){						selfLng = r.point.lng;						selfLat = r.point.lat;						map.panTo(new BMap.Point(selfLng,selfLat));						againstaddressxarp();					}					else {						//alert('failed'+this.getStatus());					}				},{enableHighAccuracy: true})			}	}			//地址解析			function addressxarp(name){				var myGeo = new BMap.Geocoder();				// 将地址解析结果显示在地图上,并调整地图视野				myGeo.getPoint(name, function(point){					if (point) {						selfLat = point.lat;						selfLng = point.lng;												localStorage.setItem('selfLat',selfLat);						localStorage.setItem('selfLng',selfLng);						//againstaddressxarp();					}else{						alert("您选择地址没有解析到结果!");					}				});			}			//返地址解析			function againstaddressxarp(){				var myGeo = new BMap.Geocoder();				// 根据坐标得到地址描述				myGeo.getLocation(new BMap.Point(selfLng,selfLat), function(result){					var addComp = result.addressComponents;					local = addComp.province + ", " + addComp.city + ", " + addComp.district;					localStorage.setItem('local',local);					map_city = addComp.city;					//addMarker(selfLng,selfLat);					//getlocalid(map_city);					localStorage.setItem('map_city',map_city);					$(".position").html(addComp.province + " " + addComp.city + " " + addComp.district + " " + addComp.street + " " + addComp.streetNumber);					var marker = new BMap.Marker(new BMap.Point(selfLng,selfLat));					map.addOverlay(marker);					map.panTo(new BMap.Point(selfLng,selfLat));					localStorage.removeItem('mapAddress');					localStorage.removeItem('position');					localStorage.setItem('position',selfLng+','+selfLat);					localStorage.setItem('mapAddress',addComp.province + "" + addComp.city + "" + addComp.district + "" + addComp.street + "" + addComp.streetNumber);                    					//console.log(addComp);					// addComp.province + ", " + addComp.city + ", " + addComp.district + ", " + addComp.street + ", " + addComp.streetNumber//					$('.weizhi').html('<span></span>'+addComp.district);//					$(".shop_list").html('');				});			}			function addMarker(lng,lat){				map.clearOverlays();				var marker = new BMap.Marker(new BMap.Point(lng, lat));				map.addOverlay(marker);			}		});	</script>	</body></html>